<center> Overview</center>

我们现在的目标是找到离散曲率的定义，因为其非常重要，而用连续性的曲率定义是不适用的。



# 长度变化

直觉：在平坦区域，法线方向的移动不会改变曲线长度；但是在曲率较大的区域，沿着曲率方向的移动会改变曲线的长度。曲率越大，沿着法线方向移动对长度影响越大

设曲线 $\gamma(s)$ 是参数化的光滑曲线，$s$ 是参数，定义在区间 $[0, L]$ 上。我们考虑在曲线 $\gamma$ 上施加一个小的扰动，记为 $\epsilon \eta$，其中 $\eta$ 是一个满足边界条件 $\eta(0) = \eta(L) = 0$ 的函数。 

曲线长度 $L(\gamma)$ 可以表示为积分形式：
$$
\text{length}(\gamma) = \int_0^L |\gamma'(s)| \, ds
$$
其中 $\gamma'(s)$ 是曲线 $\gamma$ 在点 $s$ 处的导数，表示曲线的切向量。 现在我们考虑曲线 $\gamma$ 在扰动 $\epsilon \eta$ 下的长度变化：
$$
\text{length}(\gamma + \epsilon \eta) = \int_0^L |\gamma'(s) + \epsilon \eta'(s)| \, ds
$$
我们对 $\epsilon$ 求导，并在 $\epsilon = 0$ 时计算变化率：
$$
\left. \frac{d}{d\epsilon} \right|_{\epsilon=0} \text{length}(\gamma + \epsilon \eta)
$$
具体来说，我们利用 $\eta$ 的边界条件以及法向量和曲率的关系，可以得到：
$$
\left. \frac{d}{d\epsilon} \right|_{\epsilon=0} \text{length}(\gamma + \epsilon \eta) = - \int_0^L \langle \eta(s), \kappa(s) N(s) \rangle \, ds
$$
这个公式告诉我们，长度变化的速度与扰动方向 $\eta$ 和法向量方向 $\kappa N$ 的内积成正比。因此，最有效减少曲线长度的方法是沿着法向量方向移动，且移动的速度正比于曲率。也就是说，取 $\eta = \kappa N$ 是最优选择。 



## 长度变化梯度

最简单的例子：$\ell := |b-a|$
$$
\mathbb{\nabla}_b\ell  =(b-a)/\ell
$$


离散曲率：

在光滑设定中：
$$
\mathbb{\nabla}L=\kappa N
$$
$\mathbb{\nabla}L$是长度梯度，表示曲线长度随位置变化的速度。法向量$N$是指向曲线凹侧的单位向量。



离散设定中的应用：

对于离散曲线，我们通过将每个顶点的外角$\theta_i$和法向量$N_i$结合起来：
$$
\kappa_i^B N_i:=2\sin(\theta_i /2)N_i
$$
$\theta_i$是顶点$\gamma_i$处的外角；$N_i$是顶点$\gamma_i$处的法向量。

---

总结一下当前做的事情：

在光滑设定中考虑了两种等价的定义

1. 转角
2. 长度变化

对应与离散设定中两种定于：
$$
\kappa_i^A:=\theta_i
$$

$$
\kappa_i^B:=2\sin(\theta_i/2)
$$

---

## 在离散情况下应用法线偏移

如何在离散情况下应用法线偏移？

- **第一个问题是法线在顶点处没有定义！**
- **我们至少可以沿着各个边的法线偏移这些边：**

在连续曲线中，法线在每一点处都有明确的定义，并且可以很容易地计算出曲线沿法线方向偏移后的形状。然而，在离散情况下（如多边形），法线在顶点处没有明确的定义，因为顶点是线段的交点，而不是曲线的平滑部分。

尽管法线在顶点处没有定义，但我们可以在多边形的每条边上定义法线。每条边的法线是垂直于该边的单位向量。例如，$\gamma_i$到$\gamma_{i+1}$的法线可以表示为：
$$
N_i=\frac{(\gamma_{i+1}-\gamma_i)^{\perp}}{|\gamma_{i+1}-\gamma_i|}
$$
离散情况下，有以下几种自然的方法连接：

* 沿半径为$\epsilon$的圆弧连接
  每个顶点的偏移段贡献一个角度$\theta_i$，总长度的减少量与$\Sigma_i\theta_i$成正比
* 沿直径连接
  使用直线连接，每个顶点的偏移段贡献一个$\sin(\theta_i/2)$，因此，总长度的减少量与$\Sigma_i2\sin(\theta_i/2)$成正比
* 延长边直到相交
  每个顶点的偏移段贡献一个$\tan(\theta_i/2)$，因此，总长度的减少量与$\Sigma_i 2\tan(\theta_i/2)$成正比



通过比较原始长度和法线偏移长度，我们得到另一种曲率定义，实际上，我们得到了三种定义：

$\kappa_i^{A}$定义：
$$
\kappa_i^{A}:=\theta_i
$$
直接使用顶点处的转角作为离散曲率的定义

$\kappa_i^B$定义：
$$
\kappa_i^B:=2\sin(\theta_i/2)
$$
使用了三角函数$\sin$对于小角度，与第一个定义一样，该方法对于大角度更能反应曲线的实际弯曲成都

$\kappa_i^C$定义：
$$
\kappa_i^C:=2\tan(\theta_i/2)
$$
该定义利用了三角函数$\tan$提供了另一种度量角度变化的方法。

一个最终的想法考虑密切圆，曲率是半径的倒数
$$
\kappa(p) = \frac{1}{r(p)}
$$
对于离散曲线的三个连续顶点$\gamma_{i-1},\gamma_i,\gamma_{i+1}$，可以定义一个外接圆，这个圆经过三个顶点，半径为$r_i$

因此，第四种离散曲率定义为半径的倒数
$$
\kappa_i^D:=\frac{1}{r_i}=\frac{2\sin(\theta_i)}{\omega_i}
$$
其中${\omega_i}$是顶点$\gamma_{i+1}-\gamma_{i-1}$之间的直线距离

从四种等价的光滑曲率定义开始，我们得到了四种不等价的离散曲率定义：

![image-20240721162525301](D:\zjPhD\notes\notes\CG\CMU_DDG\图片\1.png)

如何选择？
对于特定的应用，哪些属性是最重要的？我们愿意进行多少计算，关心的是什么

# 示例：曲线收缩流 

## 曲线收缩流 

曲线收缩流的一个简单版本是闭合曲线以与曲率成比例的速度在法线方向上移动：
$$
\frac{d}{dt} \gamma(s, t) = \kappa(s, t) N(s, t)
$$
其中：

- $\gamma(s, t)$ 表示曲线在时间 \(t\) 的位置。 

- $\kappa(s, t)$ 是点$ s$ 和时间 $t$ 的曲率。 
- $N(s, t)$是点 $s $和时间 $t$ 的法向量。 

*  **(TOTAL)**：总曲率在整个流动过程中保持不变。
* **(DRIFT)**：质心不偏离原点。 
* **(ROUND)**：在重缩放的情况下，流动对于圆形曲线是静止的。

近似曲率流

我们可以通过沿离散曲率法线方向逐步移动每个顶点来近似曲率流：
$$
\gamma_i^{t+1} = \gamma_i^t + \tau \kappa_i N_i
$$
其中：

$\gamma_i^t$ 表示顶点 \(i\) 在时间 \(t\) 的位置。

$\tau$是时间步长。

$\kappa_i$是顶点 $i$ 的曲率。

$N_i$是顶点$i$的法向量。

没有任何一种离散曲率能够同时捕捉光滑流动的三个特性： - 总曲率 - 质心偏移 - 圆度

| 曲率定义                                         | 总曲率 | 质心 | 圆度 |      |
| ------------------------------------------------ | ------ | ---- | ---- | ---- |
| $\kappa_i^A := \theta_i$                         | ✓      | ✗    | ✗    |      |
| $\kappa_i^B := 2 \sin(\theta_i / 2)$             | ✓      | ✓    | ✗    |      |
| $\kappa_i^D := \frac{2 \sin(\theta_i / 2)}{w_i}$ | ✗      | ✓    | ✓    |      |
|                                                  |        |      |      |      |

* **\(\kappa_i^A\)**：保持总曲率，但质心偏移且对圆形曲线不静止。

*  **\(\kappa_i^B\)**：保持总曲率和质心，但对圆形曲线不静止。

* **\(\kappa_i^D\)**：保持质心和圆形，但总曲率不保持

没有一种离散曲率定义能够同时捕捉所有三个特性。选择哪种定义取决于具体的应用需求和优先级：

1. 如果需要保持总曲率，$\kappa_i^A $或 $\kappa_i^B$是合适的选择。
2. 如果需要保持质心，$\kappa_i^B$或者$\kappa_i^D$是合适的选择。
3. 如果需要对圆形曲线静止，$\kappa_i^D$是唯一选择。