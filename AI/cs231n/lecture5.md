<center>Lecture 5 基于CNN的图像分类</center>

# 经过卷积核后的尺寸

输入的图片是$N\times N$，卷积核的尺寸是$F\times F$，则==输出的尺寸==是:
$$
(N-F)/\text{stride}+1
$$
$\text{stride}$是卷积核移动的距离

![image-20240728140132157](D:\zjPhD\notes\notes\AI\cs231n\图片\22.png)

# 卷积神经网络中常见的”零填充技术“

输入是$7\times 7$使用$3\times3$的卷积核，步长为1，边界用1像素的零填充，则输出是什么？

依旧是$7\times 7$

公式具体为：
$$
(N+2P-F)/\text{stride}+1
$$
通常，我们为了保证输入和输出大小是一致的，CONV层的步长是1，卷积尺寸是$F\times F$，对于边界填充，我们根据公式$(F-1)/2$来计算，具体推导为：
$$
\frac{N+2P-F}{\text{stride}}+1 = N,\\
if\  \text{stride}=1,\\
then\\
P = \frac{F-1}{2}.
$$
输入的为$32\times32\times3$采用10个$5\times5$的卷积核，步长为1，边界填充为2

那么输出的尺寸计算是：
$$
(32+2\times2 -5)/1+1=32
$$
我们用了10个卷积核，那么我们最后输出的是$32\times32 \times10$

那么对应的参数是多少呢？

每一个卷积核的参数是
$$
5\times5\times3+1=76
$$
加了一个偏置层

所以最后有$76\times10=760$

# 对于卷积层进行一个总结

假设输入的图像尺寸为$W_1\times H_1\times C$，如果要进行卷积操作，对于卷积有如下的超参数：

1. $k$个卷积核
2. 卷积核的尺寸为$F\times F$
3. 步长为S
4. 填充边界为P

经过这些卷积核心后，图像尺寸变为$W_2\times H_2 \times K$，并且满足，
$$
W_2 = \frac{W_1+2P-F}{S}+1\\
H_2 = \frac{H_1+2P-F}{S}+1
$$
这样的一个系统的参数量为：
$$
F^2CK+K
$$
第二个是偏置（Bias）



# 池化层Pooling layer

使得表征更小，更加易于管理

对每个活动图独立运行

池化层没有可学习的参数

引入空间不变性

![image-20240728151936009](D:\zjPhD\notes\notes\AI\cs231n\图片\24.png)

